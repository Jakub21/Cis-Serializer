<!DOCTYPE HTML><html><head><meta charset=utf-8><link rel=stylesheet href='style.css'></head><body><header><h1>CIS Serializer</h1><h4>Reviewed documentation of Compact Instruction Sequences v1</h4><p>This is a description on how to create and interpret serialized data. It is not specific to any implementation.</p><p><a href='https://github.com/Jakub21/oci.js'>Repository with my original Python implementation from 2019</a></p></header><div id=Content><section><h2>Sequences - introduction</h2><p>Each sequence represents one dictionary-like mapping object. It has an ID and a set of named parameters. Sequence is not translated into byte strings using ASCII or any other encoding method. Instead, it is built by instructions, each being 8 bits long.</p></section><section><h2>Instructions - introduction</h2><p>There are 4 types of instructions. The type is encoded in 2 first bits. The remaining 6 bits contain specific value (a kind of parameter; being 6 bits long it can range from 0 to 63). For convenience, some types and their most common values are assigned 3-letter tags. This is useful later in the documentation and helps standardize different implementations.</p></section><section><h2>Instructions - structural</h2><p>Structural type includes instructions that delimit different parts of the sequence. This type also includes number modifier instructions.</p><p>This type of instruction starts with 00</p><table><tr class=Head><td>Tag</td><td>Full name</td><td>Value</td><td>Instruction</td><td>Description</td></tr><tr><td><span class=Tag>BGN</span></td><td>Begin</td><td>0</td><td class=Bin>00 000000</td><td>Sequence structure: start of the sequence</td></tr><tr><td><span class=Tag>END</span></td><td>End</td><td>1</td><td class=Bin>00 000001</td><td>Sequence structure: end of the sequence</td></tr><tr><td><span class=Tag>PRM</span></td><td>Parameter</td><td>3</td><td class=Bin>00 000011</td><td>Sequence structure: start of the parameter name</td></tr><tr><td><span class=Tag>VAL</span></td><td>Value</td><td>4</td><td class=Bin>00 000100</td><td>Sequence structure: start of the parameter value</td></tr><tr><td><span class=Tag>NEG</span></td><td>Negative</td><td>5</td><td class=Bin>00 000101</td><td>Mark the following number as negative</td></tr><tr><td><span class=Tag>DOT</span></td><td>Decimal</td><td>6</td><td class=Bin>00 000110</td><td>Decimal sign for the numbers</td></tr></table></section><section><h2>Instructions - meta</h2><p>Meta instructions convey information about whether and how a sequence was received. They are to be processed on their own and ignored when building sequences.</p><p>This type of instruction starts with 01 (64)</p><table><tr class=Head><td>Tag</td><td>Full name</td><td>Value</td><td>Instruction</td><td>Description</td></tr><tr><td><span class=Tag>VLD</span></td><td>Valid</td><td>0</td><td class=Bin>01 000000</td><td>Received a valid sequence</td></tr><tr><td><span class=Tag>INV</span></td><td>Invalid</td><td>2</td><td class=Bin>01 000010</td><td>Received an invalid sequence</td></tr><tr><td><span class=Tag>CRT</span></td><td>Critical</td><td>7</td><td class=Bin>01 000111</td><td>Critical error, possibly unrelated to the transfer</td></tr></table></section><section><h2>Instructions - letter</h2><p><span class=Tag>LTR</span></p><p>To encode text one has to build it from letters (and a limited set of characters). Each instruction of this type contains a single letter. Uninterrupted string of these instructions creates a word.</p><p>This type of instruction starts with 11 (192)</p><table><tr class=Head><td>Content</td><td>Value</td><td>Instruction</td></tr><tr><td>a</td><td>0</td><td class=Bin>11 000000</td></tr><tr><td>z</td><td>25</td><td class=Bin>11 011001</td></tr><tr><td>A</td><td>26</td><td class=Bin>11 011010</td></tr><tr><td>Z</td><td>51</td><td class=Bin>11 110011</td></tr><tr><td>'_'</td><td>52</td><td class=Bin>11 110100</td></tr><tr><td>'.'</td><td>53</td><td class=Bin>11 110101</td></tr><tr><td>','</td><td>54</td><td class=Bin>11 110110</td></tr><tr><td>':'</td><td>55</td><td class=Bin>11 110111</td></tr><tr><td>'!'</td><td>56</td><td class=Bin>11 111000</td></tr><tr><td>'@'</td><td>57</td><td class=Bin>11 111001</td></tr><tr><td>'#'</td><td>58</td><td class=Bin>11 111010</td></tr><tr><td>'$'</td><td>59</td><td class=Bin>11 111011</td></tr><tr><td>'%'</td><td>60</td><td class=Bin>11 111100</td></tr><tr><td>'^'</td><td>61</td><td class=Bin>11 111101</td></tr><tr><td>'&'</td><td>62</td><td class=Bin>11 111110</td></tr><tr><td>'*'</td><td>63</td><td class=Bin>11 111111</td></tr></table></section><section><h2>Instructions - digit</h2><p><span class=Tag>DGT</span></p><p>Numbers can be created using digits. Each instruction of type conveys a base 64 digit (because each value has 6 bits). One instruction on its own can be an intiger from 0 to 63. Instruction value is the same as the digit value.</p><p>This type of instruction starts with 10 (128)</p><table><tr class=Head><td>Content</td><td>Value</td><td>Instruction</td></tr><tr><td>0</td><td>0</td><td class=Bin>10 000000</td></tr><tr><td>1</td><td>1</td><td class=Bin>10 000001</td></tr><tr><td>63</td><td>63</td><td class=Bin>10 111111</td></tr></table></section><section><h2>Building sequences - words</h2><p>A word is an unbroken string of instruction of letter type (<span class=Tag>LTR</span>).</p></section><section class=Build><h2>Building sequences - numbers</h2><p>Numbers are created with (base 64) digits and structural instructions "Negative" and "Decimal". See examples below.</p><table><tr class=Head><td>Number</td><td>Sequence</td></tr><tr><td>1</td><td><span class=Tag>DGT 1</span></td></tr><tr><td>-40</td><td><span class=Tag>NEG</span><span class=Tag>DGT 40</span></td></tr><tr><td>66 (64+2)</td><td><span class=Tag>DGT 1</span><span class=Tag>DGT 2</span></td></tr><tr><td>158 (128+30)</td><td><span class=Tag>DGT 2</span><span class=Tag>DGT 30</span></td></tr><tr><td>0.75 (48/64)</td><td><span class=Tag>DOT</span><span class=Tag>DGT 48</span></td></tr><tr><td>2.00073... (2 + 3/4096)</td><td><span class=Tag>DGT 2</span><span class=Tag>DOT</span><span class=Tag>DGT 0</span><span class=Tag>DGT 3</span></td></tr></table></section><section><h2>Building sequences - structure</h2><p>For a sequence to be valid it has to have both delimiting tags and an ID. Its ID must be a word. The example below creates a sequence with ID "Hello"</p><p class=Sequence><span class=Tag>BGN</span><span class=Tag>LTR H</span><span class=Tag>LTR e</span><span class=Tag>LTR l</span><span class=Tag>LTR l</span><span class=Tag>LTR o</span><span class=Tag>END</span></p><p>Which would look like this if specific values were shown instead of tags.</p><p class=Sequence><span class=Num>00000000</span><span class=Num>11000111</span><span class=Num>11000100</span><span class=Num>11001011</span><span class=Num>11001011</span><span class=Num>11001110</span><span class=Num>00000001</span></p><p>or in hexadecimal</p><span class=Sequence><span class=Num>00</span><span class=Num>C7</span><span class=Num>C4</span><span class=Num>CB</span><span class=Num>CB</span><span class=Num>CE</span><span class=Num>01</span></span><p>From now in I will merge repeated letter and digit instructions for easier viewing, like below.</p><p class=Sequence><span class=Tag>BGN</span><span class=Tag>LTR "Hello"</span><span class=Tag>END</span></p><p>This however does not convey too much information and is inefficient on its own. The point of this project is serialization of mappings. To add map entries, parameters are to be used. All parameters need a name and a value. The name has to be a word. Structural instructions are used to mark start of both name and value. Any mapping where keys are strings and values are either strings or numbers can be encoded. Just keep in mind the limited set of characters.</p><p>The example below creates a sequence with ID "Greet" and a parameter named "who" with value "World"</p><p class=Sequence><span class=Tag>BGN</span><span class=Tag>LTR "Greet"</span><span class=Tag>PRM</span><span class=Tag>LTR "who"</span><span class=Tag>VAL</span><span class=Tag>LTR "World"</span><span class=Tag>END</span></p><p>Parameter value can be either a word or a number and any number of them can be added. The example below creates a sequence with id "Shopping", text parameter "where" with value "bakery" and a numerical parameter "buns" with value 6</p><p class=Sequence><span class=Tag>BGN</span><span class=Tag>LTR "Shopping"</span><span class=Tag>PRM</span><span class=Tag>LTR "where"</span><span class=Tag>VAL</span><span class=Tag>LTR "bakery"</span><span class=Tag>PRM</span><span class=Tag>LTR "buns"</span><span class=Tag>VAL</span><span class=Tag>DGT 6</span><span class=Tag>END</span></p></section><section><h2>Limitations</h2><ol><li><h4>Limited set of characters</h4><p>It is not possible to encode full UTF-8 (or even full ASCII) with this method.</p></li><li><h4>No support for arrays and nesting</h4><p>One can not encode an array (or any other collection). Also it is not possible to nest a sequence inside another.</p></li><li><h4>Fractions precision</h4><p>It might not be very clear how many digits are required to encode a fraction. After decimal point each digit multiplies the precision by 64. 1 digit after the decimal point can encode all multiplies of 1/64. (2 can encode all multiplies of 1/4096 and 3 all multiplies of 1/262144 and so on)</p></li></ol></section></div><footer>Project: 2019 Q4<br>Documentation: 2022 Q2<br>Jakub21</footer></body></html>